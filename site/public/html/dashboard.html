<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ViaTech | Dashboard</title>

    <!-- CSS -->
    <link rel="stylesheet" href="../css/dashboard.css">
    <link rel="stylesheet" href="../css/menuLateral.css">

    <!-- JS -->
    <script src="../js/menuLateral.js"></script>
    <script src="../js/sessao.js"></script>
    <script src="https://www.gstatic.com/charts/loader.js"></script>


    <!-- STYLE & ICONES-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons"rel="stylesheet">
    <link rel="stylesheet"href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
</head>

<body onload="validarSessao(), obterInfoHardware(), clicarMenu()">
<!-- <body> -->
        

        <nav id="menuLateral">
            <i style="display: none; font-size: 50px;" id="menuEscondido" class="material-icons" onclick="clicarMenu()">menu</i>
            
            <div class="container" id="containerMenuLateral">
                
                <p style="display: flex; align-items: center;">
                    <img id="imgViaTech" src="../assets/imgs/icon.svg"> ViaTech
                    <i class="material-icons" onclick="clicarMenu()">menu</i>
                </p>
                
                <p>Olá, <span id="ola">Undefined</span></p>
                
            <div id="containerItens" class="container-itens">
                <div class="item">
                    <a href="dashboard.html"><span class="material-symbols-outlined">account_circle</span> Perfil</a>
                </div>
                
                <div class="item">
                    <a href="dashboard.html"> <span class="material-symbols-outlined">monitoring</span> Dashboard</a>
                </div>
                
                <div class="item">
                    <a href="dashboard.html"> <span class="material-symbols-outlined">notifications_active</span> Alertas</a>
                </div>
                
                
                <div class="item">
                    <a href="dashboard.html"> <span class="material-symbols-outlined">add_circle</span> Máquinas</a>
                </div>
                
                
                <div class="item">
                    <a href="cadastroFuncionario.html"> <span class="material-symbols-outlined">groups</span> Funcionários</a>
                </div>
                
            </div>
            
            <div onclick="logout()" class="buttonSair">
                <a> <span class="material-symbols-outlined">logout</span>Sair</a>
            </div>
            
        </nav>
        
        <!-- dashboard.css -->
        
        <div class="header-info">
            <div class="info">
                <div class="info1">

                    <select onchange="obterInfoHardware()" id="estacao" class="select-estacao">
                        <option value="" disabled selected>Selecione uma estação</option>
                        <option value="1">Araraquara</option>
                        <option value="2">Guaianases</option>
                    </select>
                </div>
                <div class="info2">

                    Sistema Operacional: <span id="span_so" class="span-so">undefined</span>
                    CPU: <span id="span_cpu" class="span-cpu">undefined</span>
                    RAM: <span id="span_ram" class="span-ram">undefined</span>
                    Disco: <span id="span_disco" class="span-disco">undefined</span>
                    Em uso: <span id="span_uso" class="span-uso">undefined</span>
                </div>

            </div>
        </div>
        
        <div class="container-principal">


            <div class="coluna-1">
                <div class="container-graficos">
                    <div class="graficos-coluna-1">
                        <!-- <h3>Uso de CPU %</h3> -->
                        <div id="grafico_cpu" class="grafico-cpu"></div>
                        <!-- <h3>Uso de RAM %</h3> -->
                        <div id="grafico_ram" class="grafico-ram"></div>
                    </div>

                    <div class="graficos-coluna-2">
                        <!-- <h3>Uso de disco %</h3> -->
                        <div id="grafico_disco" class="grafico-disco"></div>
                        <!-- <h3>Temperatura da máquina ºC</h3> -->
                        <div id="grafico_temperatura" class="grafico-temperatura"></div>
                    </div>
                </div>

                <div class="container-kpis">
                    <div class="kpi-cpu">
                        <strong>Quantidade de problemas na última semana:</strong> <br>
                        10
                    </div>
                    <div class="kpi-disco">
                        <strong>Utilização de disco</strong> <br>
                        90%
                    </div>
                    <div class="kpi-ram">
                        <strong>Utilização de ram</strong> <br>
                        90%
                    </div>
                    <div class="kpi-temperatura">
                        <strong>Utilização de cpu</strong> <br>
                        90%
                    </div>
                </div>
            </div>

            <div class="coluna-2">
                <div class="container-indicadores">
                    <h3>Disco Rígido:</h3>
                    <div class="indicadores-linha">
                        <div class="indicador" style="background-color: #7ed957">1% á 75%</div>
                        <div class="indicador" style="background-color: #ffde59">76% á 88%</div>
                        <div class="indicador" style="background-color: #ff3131">89% á 100%</div>
                    </div>

                    <h3>Memória RAM:</h3>
                    <div class="indicadores-linha">
                        <div class="indicador" style="background-color: #7ed957">1% á 75%</div>
                        <div class="indicador" style="background-color: #ffde59">76% á 88%</div>
                        <div class="indicador" style="background-color: #ff3131">89% á 100%</div>
                    </div>

                    <h3>CPU:</h3>
                    <div class="indicadores-linha">
                        <div class="indicador" style="background-color: #7ed957">1% á 75%</div>
                        <div class="indicador" style="background-color: #ffde59">76% á 88%</div>
                        <div class="indicador" style="background-color: #ff3131">89% á 100%</div>
                    </div>

                    <h3>Temperatura CPU:</h3>
                    <div class="indicadores-linha">
                        <div class="indicador" style="background-color: #7ed957">15°C á 44°C</div>
                        <div class="indicador" style="background-color: #ffde59">45°C Á 56°C</div>
                        <div class="indicador" style="background-color: #ff3131">56°C></div>
                    </div>
                </div>


                <div class="container-usb">
                    <div class="usb-header">USB's Conectados</div>
                    <div class="usb-body">
                        USB Root Hub (USB 3.0) 
                        Mouse Speed SPTECH
                        PenDrive    
                    </div>
                </div>
            </div>

            <div class="coluna-3">
                <div class="container-alertas">
                    <div class="alertas-header"><strong>Notificações - Alertas</strong></div>
                    <div class="alertas-quadrado">Disaster - Estação Luz <br>
                        CPU > 89%</div>
                    <div class="alertas-quadrado">Disaster - Estação Luz <br>
                        CPU > 89%</div>
                    <div class="alertas-quadrado">Disaster - Estação Luz <br>
                        CPU > 89%</div>
                    <div class="alertas-quadrado">Disaster - Estação Luz <br>
                        CPU > 89%</div>
                    <div class="alertas-quadrado">Disaster - Estação Luz <br>
                        CPU > 89%</div>
                    <div class="alertas-quadrado">Disaster - Estação Luz <br>
                        CPU > 89%</div>
                    <div class="alertas-quadrado">Disaster - Estação Luz <br>
                        CPU > 89%</div>
                    <div class="alertas-quadrado">Disaster - Estação Luz <br>
                        CPU > 89%</div>
                </div>
            </div>

        </div>
</body>
</html>

<script>
    function obterInfoHardware() {
        var fkComputador = estacao.value;

    fetch(`/dashboard/obterInfoHardware`,{
        method: "POST",
        headers: {
        "Content-Type": "application/json"
       },
       body: JSON.stringify({
        fkComputadorServer: fkComputador
       })
     })
    .then(function (response) {
    if (response.ok) {
        response.json().then(function (resposta) {
                
            resposta.reverse();

                console.log(resposta)
                span_so.innerHTML = resposta[0].SistemaOperacional
                span_cpu.innerHTML = resposta[0].NomeCpu
                span_ram.innerHTML = resposta[0].Arquitetura
                span_disco.innerHTML = resposta[0].MemoriaEmUso
                span_uso.innerHTML = resposta[0].MemoriaTotal
                // plotarGrafico(resposta);

            });
        } else {
            console.error('Nenhum dado encontrado ou erro na API' + error);
        }
    })
    .catch(function (error) {
        console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
    });
    }

    google.charts.load('current', { packages: ['coreChart'] });
    google.charts.setOnLoadCallback(drawCPU);
    google.charts.setOnLoadCallback(drawRAM);
    google.charts.setOnLoadCallback(drawDisco);
    google.charts.setOnLoadCallback(drawTemperatura);

function drawCPU() {
   var data = new google.visualization.DataTable();
   data.addColumn("string", "Data/Hora");
   data.addColumn("number", "% de uso");
   data.addRow(['10', 10]);
   data.addRow(['20', 20]);
   data.addRow(['30', 30]);
   data.addRow(['40', 40]);
   data.addRow(['90', 90]);

   var options = {
      title: 'Uso de CPU %',
      legend: 'none',
      chartArea: { 'width': '84%' },
      backgroundColor: '#efefef',
      colors: ['#9747FF']
   };

   var chart = new google.visualization.AreaChart(document.getElementById("grafico_cpu"));
   chart.draw(data, options);
}

function drawRAM(dados) {
   var data = new google.visualization.DataTable();
   data.addColumn("string", "Data/Hora");
   data.addColumn("number", "% de uso");
   data.addRow(['10', 10]);
   data.addRow(['20', 20]);
   data.addRow(['30', 30]);
   data.addRow(['40', 40]);
   data.addRow(['90', 90]);


   var options = {
      title: 'Uso de RAM %',
      legend: 'none',
      chartArea: { 'width': '84%' },
      backgroundColor: '#efefef',
      colors: ['green']
   };

   var chart = new google.visualization.AreaChart(document.getElementById("grafico_ram"));
   chart.draw(data, options);
}

function drawDisco(dados) {
   var data = new google.visualization.DataTable();
   data.addColumn("string", "Data/Hora");
   data.addColumn("number", "% de uso");
   data.addRow(['10', 10]);
   data.addRow(['20', 20]);
   data.addRow(['30', 30]);
   data.addRow(['40', 40]);
   data.addRow(['90', 90]);


   var options = {
      title: "Uso de Disco %",
      legend: 'none',
      chartArea: { 'width': '84%' },
      backgroundColor: '#efefef',
      colors: ['blue']
   };

   var chart = new google.visualization.AreaChart(document.getElementById("grafico_disco"));
   chart.draw(data, options);
}

function drawTemperatura(dados) {
   var data = new google.visualization.DataTable();
   data.addColumn("string", "Data/Hora");
   data.addColumn("number", "% de uso");
   data.addRow(['10', 10]);
   data.addRow(['20', 20]);
   data.addRow(['30', 30]);
   data.addRow(['40', 40]);
   data.addRow(['90', 90]);


   var options = {
      title: "Temperatura ºC",
      legend: 'none',
      chartArea: { 'width': '84%' },
      backgroundColor: '#efefef',
      colors: ['red']
   };

   var chart = new google.visualization.AreaChart(document.getElementById("grafico_temperatura"));
   chart.draw(data, options);
}



</script>