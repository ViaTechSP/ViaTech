<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ViaTech | Funcionários</title>
    <!-- <link rel="stylesheet" href="./css/dashboard.css"> -->
    <link rel="stylesheet" href="../css/funcionario.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons"rel="stylesheet">
    <link rel="stylesheet" href="../css/menuLateral.css">
    <!-- <script src="../js/funcionario.js" defer></script> -->
    <script src="../js/sessao.js"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet"href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"></script>
</head>
<!-- <body onload="validarSessao()"> -->
<body>
        <!-- dashboard.css -->
    <div class="menuHeader">
        
        <!-- menuLateral.css -->
        <nav id="menuLateral">
            <i style="display: none;" id="menuEscondido" class="material-icons" onclick="clicarMenu()">menu</i>
            
            <div class="container" id="containerMenuLateral">
                
                <p style="display: flex; align-items: center;">
                    <img id="imgViaTech" src="../assets/icon/icon.svg"> ViaTech
                    <i class="material-icons" onclick="clicarMenu()">menu</i>
                </p>
                
                <p>Olá, <span id="ola"></span></p>
                
            <div id="containerItens" class="container-itens">
                <div class="item">
                    <a href="perfil.html"><span class="material-symbols-outlined">account_circle</span> Perfil</a>
                </div>
                
                <div class="item">
                    <a href="dashboard_geral.html"> <span class="material-symbols-outlined">monitoring</span> Dashboard</a>
                </div>
                
                <div class="item">
                    <a href="dashboard.html"> <span class="material-symbols-outlined">notifications_active</span> Alertas</a>
                </div>
                
                
                <div class="item">
                    <a href="dashboard.html"> <span class="material-symbols-outlined">add_circle</span> Adicionar</a>
                </div>
                
                
                <div class="item">
                    <a style="color: #e6e62c;"> <span class="material-symbols-outlined item-atual">groups</span> Funcionários</a>
                </div>
                
            </div>
            
            <div class="buttonSair">
                <a> <span class="material-symbols-outlined">logout</span>Sair</a>
            </div>
            
        </nav>
    </div>
    
    <!-- dashboard.css -->
    <h2>Funcionário</h2>
    <div id="formularioAdd">
        <div class="coluna">
            <p>Nome</p>
            <input id="input_nome" type="text">
            <p id="errado_nome" class="errado"></p>
            
            <p>CPF</p>
            <input type="text" id="input_cpf">
            <p id="errado_cpf" class="errado"></p>
            
            <p>Email</p>
            <input type="text" id="input_email">
            <p id="errado_email" class="errado"></p>
        </div>
        <div class="coluna">

            <p>Cargo</p>
            <input id="input_cargo" type="text">
            <p id="errado_cargo" class="errado"></p>
            
            <p>Senha</p>
            <input id="input_senha" type="password">
            <p id="errado_senha" class="errado"></p>
        </div>
        <div class="botao">
            <button onclick="cadastrarFun()" class="botaoCadastrar">Cadastrar</button>
        </div>
    </div>

    <div id="formularioExibir" style="display: none;">
        <div id="primeiraColuna" class="coluna1">
            
        </div>
        <div id="segundaColuna" class="coluna1">

        </div>

    </div> 
   
    <!-- <div id="formularioExcluir" style="display: none;"> -->
        <!-- <div class="coluna">
            <p>Nome</p>
            <input id="input_nome" type="text">
            <p id="errado_nome" class="errado"></p>
            
            <p>CPF</p>
            <input type="text" id="input_cpf"  required>
            <p id="errado_cpf" class="errado"></p>
            
            <p>Email</p>
            <input type="text" id="input_email">
            <p id="errado_email" class="errado"></p>
        </div>
        <div class="coluna">
            <p>Telefone</p>
            <input id="input_telefone" type="text" required>
            <p id="errado_telefone" class="errado"></p>
            
            <p>Cargo</p>
            <input id="input_cargo" type="text">
            <p id="errado_cargo" class="errado"></p>
            
            <p>Senha</p>
            <input id="input_senha" type="password">
            <p id="errado_senha" class="errado"></p>
        </div>
        <div class="botao">
            <button onclick="()" class="botaoCadastrar">Cadastrar</button>
        </div> 
    </div> -->

    <!-- <div id="formularioEditar" style="display: none;"> -->
        <!-- <div class="coluna">
            <p>Nome</p>
            <input id="input_nome" type="text">
            <p id="errado_nome" class="errado"></p>
            
            <p>CPF</p>
            <input type="text" id="input_cpf"  required>
            <p id="errado_cpf" class="errado"></p>
            
            <p>Email</p>
            <input type="text" id="input_email">
            <p id="errado_email" class="errado"></p>
        </div>
        <div class="coluna">
            <p>Telefone</p>
            <input id="input_telefone" type="text" required>
            <p id="errado_telefone" class="errado"></p>
            
            <p>Cargo</p>
            <input id="input_cargo" type="text">
            <p id="errado_cargo" class="errado"></p>
            
            <p>Senha</p>
            <input id="input_senha" type="password">
            <p id="errado_senha" class="errado"></p>
        </div>
        <div class="botao">
            <button onclick="()" class="botaoCadastrar">Cadastrar</button>
        </div> 
    </div> -->


    <div class="menuDireita">
        <div id="containerItens" class="container-itens">
            <div class="itemDireita">
                <a href="#"><span id="ver" onclick="exibirFun()" class="iconDireita material-symbols-outlined">visibility</span></a>
            </div>
            
            <div class="item">
                <a href=""> <span class="iconDireita material-symbols-outlined">Edit</span></a>
            </div>
            
            <div class="item">
                <a href="#"> <span id="adicionarFuncionario" onclick="addFun()" class="iconDireita material-symbols-outlined">Person_Add</span></a>
            </div>
            
            
            <div class="item">
                <a href=""> <span onclick="excluirFun()" class="iconDireita material-symbols-outlined">Person_Remove</span></a>
            </div>
            
        </div>

    </div>

</div>

    
</body>
</html>
<script>
    $(document).ready(function(){
        $('#input_cpf').mask('000.000.000-00');
    });

    function clicarMenu() {
    const menu = document.getElementById('menuLateral');
    menu.classList.toggle('escondido');

    if (menu.classList.contains('escondido')) {
        menuEscondido.style.display = 'block'
        containerMenuLateral.style.display = 'none';
    }
    else {
        menuEscondido.style.display = 'none'
        containerMenuLateral.style.display = 'block'
    }
    }

    /*function exibirFun() {
        document.getElementById('formularioExibir').style.display = 'block';
        document.getElementById('formularioAdd').style.display = 'none';
        document.getElementById('formularioExcluir').style.display = 'none';
        document.getElementById('formularioEditar').style.display = 'none';





    }

    function addFun() {
        document.getElementById('formularioAdd').style.display = 'block';
        document.getElementById('formularioExcluir').style.display = 'none';
        document.getElementById('formularioEditar').style.display = 'none';
        document.getElementById('formularioExibir').style.display = 'none';
    }

    function excluirFun() {
        document.getElementById('formularioAdd').style.display = 'none';
        document.getElementById('formularioExcluir').style.display = 'block';
        document.getElementById('formularioEditar').style.display = 'none';
        document.getElementById('formularioExibir').style.display = 'none';
    }
*/

   function cadastrarFun() {
        var nome = input_nome.value;
        var cpf = input_cpf.value
        var email = input_email.value;
        var senha = input_senha.value;
        var cargo = input_cargo.value;
        var fkEmpresa = sessionStorage.ID_EMPRESA;
        
        var validacaoNulo = nome != null && cpf != null && email != null && senha != null && fkEmpresa != null;
        var validacaoVazio = nome != '' && cpf != '' && email != '' && senha != '' && fkEmpresa != '';
        var validacaoSenha = (senha.length >= 6 && ((senha.indexOf("@") >= 0) || (senha.indexOf("!") >= 0) || (senha.indexOf("#") >= 0) || (senha.indexOf(".") >= 0) || (senha.indexOf("?") >= 0)))
      
        if (validacaoNulo && validacaoVazio) {
          if (validacaoSenha) {
      
            fetch("/usuarios/cadastrarFun", {
              method: "POST", 
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify({
                nomeServer: nome,
                cpfServer: cpf,
                emailServer: email,
                senhaServer: senha,
                fkEmpresaServer: fkEmpresa
              }),
            }).then(function (resposta) {
              if (resposta.ok) {
              //   swal.fire({
              //     title: 'Redirecionando para o login',
              //     text: 'Aguarde...',
              //     icon: 'info',
              //     timer: 2500,
              //     showConfirmButton: false,
              // }).then(() => {
                  swal('sucesso', 'Cadastro realizado!')
              // });
              } else {
                resposta.text().then(function (texto) {
                });
              }
            }).catch(function (error) {
              console.error('Erro na requisição:', error);
              alert('Erro ao cadastrar: ' + error.message);
            });
            
          } else {
            swal('Erro', "Senha inválida!");
          }
      } else {
        swal('Erro', "Preencha todos os campos corretamente");
      }
      }

</script>